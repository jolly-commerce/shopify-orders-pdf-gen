<form id="upload-form">
    <input type="file" id="file-input" name="file">
    <input type="submit" value="Upload">
  </form>
  
  <script>
    // Handle form submission
    const form = document.getElementById('upload-form');
    form.addEventListener('submit', async (event) => {
      event.preventDefault();
  
      // Parse the CSV file
      const fileInput = document.getElementById('file-input');
      const file = fileInput.files[0];
      const data = await parseCsvFile(file);
  
      // Send data to the server
      const response = await fetch('/.netlify/functions/generate-pdf', {
        method: 'POST',
        body: JSON.stringify(data),
      });
  
      // Handle the server response
      const pdf = await response.blob();
      const link = document.createElement('a');
      link.href = URL.createObjectURL(pdf);
      link.download = 'addresses.pdf';
      link.click();
    });
  
    // Parse the CSV file
    async function parseCsvFile(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => {
          const csvData = reader.result;
          Papa.parse(csvData, {
            header: true,
            complete: (results) => {
              resolve(results.data);
            },
          });
        };
        reader.readAsText(file);
      });
    }
  </script>
  